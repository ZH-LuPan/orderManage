
<link rel="stylesheet" href="../public/layui/css/layui.css">
<div style="padding: 15px;">
    <div class="layui-form">
        <div class="layui-form-item">
            <label class="layui-form-label">姓名</label>
            <div class="layui-input-block">
                <input type="text" name="user_name"  value="" placeholder="请输入姓名" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">手机号码</label>
            <div class="layui-input-block">
                <input type="text" name="phone"  value=""   placeholder="请输入微信" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">微信</label>
            <div class="layui-input-block">
                <input type="text" name="wechat"  value=""   placeholder="请输入微信" autocomplete="off" class="layui-input">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">日期</label>
            <div class="layui-input-block">
                <input type="text" name="order_date"  placeholder="请输入日期" autocomplete="off" class="layui-input" id="date" />
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">收货地址</label>
            <div class="layui-input-block">
                <input type="text" name="address"  value=""   placeholder="请输入收货地址" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">右眼度数</label>
            <div class="layui-input-block">
                <input type="text" name="right_eye_num"  value=""   placeholder="请输入右眼度数" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">右眼散光</label>
            <div class="layui-input-block">
                <input type="text" name="right_eye_light"  value=""   placeholder="请输入右眼散光" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">右眼轴位</label>
            <div class="layui-input-block">
                <input type="text" name="right_eye_axle"  value=""   placeholder="请输入右眼轴位" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">左眼度数</label>
            <div class="layui-input-block">
                <input type="text" name="left_eye_num"  value=""   placeholder="请输入左眼度数" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">左眼散光</label>
            <div class="layui-input-block">
                <input type="text" name="left_eye_light"  value=""   placeholder="请输入左眼散光" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">左眼轴位</label>
            <div class="layui-input-block">
                <input type="text" name="left_eye_axle"  value=""   placeholder="请输入左眼轴位" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">瞳距</label>
            <div class="layui-input-block">
                <input type="text" name="eye_len"  value=""   placeholder="请输入瞳距" autocomplete="off" class="layui-input">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">镜架</label>
            <div class="layui-input-block">
                <input type="text" name="eyeglasses_frame"  value=""   placeholder="请输入镜架" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">镜片</label>
            <div class="layui-input-block">
                <input type="text" name="eyeglasses"  value=""   placeholder="请输入镜片" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">价格</label>
            <div class="layui-input-block">
                <input type="text" name="price"  value=""   placeholder="请输入价格" autocomplete="off" class="layui-input">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">接待编号</label>
            <div class="layui-input-block">
                <input type="text" name="service_no"  value=""   placeholder="请输入接待编号" autocomplete="off" class="layui-input">
            </div>
        </div>

        <!--<div class="layui-form-item">-->
            <!--<label class="layui-form-label">订单图片</label>-->
            <!--<button type="button" class="layui-btn" id="upload">-->
                <!--<i class="layui-icon">&#xe67c;</i>上传图片-->
            <!--</button>-->
        <!--</div>-->
        <!--<div class="layui-form-item">-->
            <!--<label class="layui-form-label"></label>-->
            <!--<div id="imageList">-->

            <!--</div>-->
        <!--</div>-->

        <div class="layui-form-item">
            <label class="layui-form-label">备注</label>
            <div class="layui-input-block">
                <textarea name="description" placeholder="请输入内容" class="layui-textarea"></textarea>
            </div>
        </div>

    </div>
    <div class="layui-form-item">
        <div class="layui-input-block">
            <button class="layui-btn" id="submitBtn">立即提交</button>
            <input type="hidden" name="id" value="">
            <input type="hidden" name="order_no" value="">
        </div>
    </div>
</div>
<script src="../public/layui/layui.all.js"></script>
<script src="../public/jquery-1.11.3/jquery.min.js"></script>
<script src="../public/static/js/common.js"></script>
<script>
    layui.use('laydate', function(){
        var laydate = layui.laydate;
        laydate.render({
            elem: '#date' //指定元素
            ,type:'date'
        });
    });
</script>
<script>
    $(function () {
        var id = getUrlParam('id');
        $('input[name="id"]').val(id);
        if(id){
            pageDateInit(id);
        }
    })
    function pageDateInit(id){
        $.post('../action/order.php?action=addOrder&id='+id,{},function (res) {
            var result = JSON.parse(res);
            if(result.code === 200){
                $('input[name="id"]').val(result.data.id);
                $('input[name="user_name"]').val(result.data.user_name);
                $('input[name="wechat"]').val(result.data.wechat);
                $('input[name="phone"]').val(result.data.phone);
                $('input[name="order_date"]').val(result.data.order_date);
                $('input[name="order_no"]').val(result.data.order_no);
                $('input[name="address"]').val(result.data.address);
                $('input[name="right_eye_num"]').val(result.data.right_eye_num);
                $('input[name="right_eye_light"]').val(result.data.right_eye_light);
                $('input[name="right_eye_axle"]').val(result.data.right_eye_axle);
                $('input[name="left_eye_num"]').val(result.data.left_eye_num);
                $('input[name="left_eye_light"]').val(result.data.left_eye_light);
                $('input[name="left_eye_axle"]').val(result.data.left_eye_axle);
                $('input[name="eye_len"]').val(result.data.eye_len);
                $('input[name="eyeglasses_frame"]').val(result.data.eyeglasses_frame);
                $('input[name="eyeglasses"]').val(result.data.eyeglasses);
                $('input[name="price"]').val(result.data.price);
                $('input[name="service_no"]').val(result.data.service_no);
                $('textarea[name="description"]').val(result.data.description);
            }
        })
    }

    $('#submitBtn').on('click',function () {
        let id = $('input[name="id"]').val();
        let user_name = $('input[name="user_name"]').val();
        let wechat = $('input[name="wechat"]').val();
        let phone = $('input[name="phone"]').val();
        let order_date = $('input[name="order_date"]').val();
        let order_no = $('input[name="order_no"]').val();
        let address = $('input[name="address"]').val();
        let right_eye_num = $('input[name="right_eye_num"]').val();
        let right_eye_light = $('input[name="right_eye_light"]').val();
        let right_eye_axle = $('input[name="right_eye_axle"]').val();
        let left_eye_num = $('input[name="left_eye_num"]').val();
        let left_eye_light = $('input[name="left_eye_light"]').val();
        let left_eye_axle = $('input[name="left_eye_axle"]').val();
        let eye_len = $('input[name="eye_len"]').val();
        let eyeglasses_frame = $('input[name="eyeglasses_frame"]').val();
        let eyeglasses = $('input[name="eyeglasses"]').val();
        let price = $('input[name="price"]').val();
        let service_no = $('input[name="service_no"]').val();
        let description = $('textarea[name="description"]').val();
        if(!user_name){
            layer.msg('用户名不能为空');return;
        }
        if(!wechat){
            layer.msg('微信不能为空');return;
        }
        if(!phone){
            layer.msg('电话不能为空');return;
        }
        if(!order_date){
            layer.msg('订单日期不能为空');return;
        }
        if(!address){
            layer.msg('收货地址不能为空');return;
        }
        // if(!right_eye_num){
        //     layer.msg('右眼度数不能为空');return;
        // }
        // if(!right_eye_light){
        //     layer.msg('右眼散光不能为空');return;
        // }
        // if(!right_eye_axle){
        //     layer.msg('右眼轴位不能为空');return;
        // }
        // if(!left_eye_num){
        //     layer.msg('左眼度数不能为空');return;
        // }
        // if(!left_eye_light){
        //     layer.msg('左眼散光不能为空');return;
        // }
        // if(!left_eye_axle){
        //     layer.msg('左眼轴位不能为空');return;
        // }
        // if(!eye_len){
        //     layer.msg('瞳距不能为空');return;
        // }
        if(!eyeglasses_frame){
            layer.msg('镜架不能为空');return;
        }
        if(!eyeglasses){
            layer.msg('镜片不能为空');return;
        }
        if(!price){
            layer.msg('价格不能为空');return;
        }
        if(!service_no){
            layer.msg('接待编号不能为空');return;
        }
        let sendData = {
            'id' : id,
            'user_name' : user_name,
            'wechat' : wechat,
            'phone' : phone,
            'order_date' : order_date,
            'order_no' : order_no,
            'address' : address,
            'right_eye_num' : right_eye_num,
            'right_eye_light' : right_eye_light,
            'right_eye_axle' : right_eye_axle,
            'left_eye_num' : left_eye_num,
            'left_eye_light' : left_eye_light,
            'left_eye_axle' : left_eye_axle,
            'eye_len' : eye_len,
            'eyeglasses_frame' : eyeglasses_frame,
            'eyeglasses' : eyeglasses,
            'price' : price,
            'service_no': service_no,
            'description' : description

        }
        $.post('../action/order.php?action=addOrder',sendData,function (res) {
            let result = JSON.parse(res);
            if(result.code === 200){
                layer.msg(result.msg,{'icon':1})
                var index = parent.layer.getFrameIndex(window.name);
                parent.layer.close(index);
            }else{
                layer.msg(result.msg,{'icon':2})
            }
        })
    })

</script>